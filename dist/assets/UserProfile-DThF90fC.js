import{c as j,u as P,R as S,r as f,j as e,a as U,M as D,L as b,t as x,z as F}from"./index-DprZlJN8.js";import{B as _}from"./building-DGwLmj9t.js";import{S as A}from"./save-BDs7dtbN.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=j("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=j("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function H({data:I,onSave:p}){const{user:a,updateProfile:k}=P(),y=S.useRef(null),[v,h]=f.useState(!1),[r,g]=f.useState(()=>{var t,o,l,i;return{name:((t=a==null?void 0:a.user_metadata)==null?void 0:t.name)||(a==null?void 0:a.name)||"",email:(a==null?void 0:a.email)||"",role:((o=a==null?void 0:a.user_metadata)==null?void 0:o.role)||(a==null?void 0:a.role)||"",bio:((l=a==null?void 0:a.user_metadata)==null?void 0:l.bio)||(a==null?void 0:a.bio)||"",password:"",confirmPassword:"",photoUrl:((i=a==null?void 0:a.user_metadata)==null?void 0:i.photoUrl)||(a==null?void 0:a.photoUrl)||""}});f.useEffect(()=>{a&&g(t=>{var o,l,i,s;return{...t,name:((o=a.user_metadata)==null?void 0:o.name)||a.name||t.name,email:a.email||t.email,role:((l=a.user_metadata)==null?void 0:l.role)||a.role||t.role,bio:((i=a.user_metadata)==null?void 0:i.bio)||a.bio||t.bio,photoUrl:((s=a.user_metadata)==null?void 0:s.photoUrl)||a.photoUrl||t.photoUrl}})},[a]);const m=t=>{g({...r,[t.target.name]:t.target.value})},w=()=>{y.current.click()},N=t=>{const o=t.target.files[0];if(o){const l=new FileReader;l.onload=i=>{const s=new Image;s.onload=()=>{const u=document.createElement("canvas");let n=s.width,d=s.height;const c=250;n>d?n>c&&(d*=c/n,n=c):d>c&&(n*=c/d,d=c),u.width=n,u.height=d,u.getContext("2d").drawImage(s,0,0,n,d);const E=u.toDataURL("image/jpeg",.6);g({...r,photoUrl:E})},s.src=i.target.result},l.readAsDataURL(o)}},C=async t=>{t.preventDefault(),h(!0);try{if(r.password&&r.password!==r.confirmPassword){x.error("As senhas não coincidem!"),h(!1);return}if(await new Promise(s=>setTimeout(s,800)),r.password){const{error:s}=await F.auth.updateUser({password:r.password});if(s){console.error("Password update error:",s),x.error("Erro ao atualizar senha",{description:s.message==="weak_password"?"A senha deve ter pelo menos 6 caracteres.":"Não foi possível alterar sua senha."}),h(!1);return}x.success("Senha atualizada com sucesso!")}const{password:o,confirmPassword:l,...i}=r;k(i),x.success("Perfil atualizado com sucesso!",{description:"Suas informações foram salvas."}),g(s=>({...s,password:"",confirmPassword:""})),p&&p()}catch(o){console.error("Profile save error:",o),x.error("Erro ao salvar perfil.",{description:"Verifique os dados e tente novamente."})}finally{h(!1)}};return v?e.jsxs("div",{className:"flex flex-col items-center justify-center h-[600px] animate-in fade-in duration-300",children:[e.jsx(U,{className:"w-16 h-16 animate-spin text-[#FD295E] mb-6"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"Salvando Perfil..."}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Atualizando suas informações"})]}):e.jsxs("div",{className:"p-8 max-w-4xl mx-auto animate-in fade-in zoom-in-95 duration-200",children:[e.jsx("h1",{className:"text-3xl font-black text-gray-900 dark:text-white mb-2",children:"Meu Perfil"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-8",children:"Gerencie suas informações pessoais e de acesso."}),e.jsxs("form",{onSubmit:C,className:"bg-white dark:bg-[#111] rounded-3xl p-8 shadow-xl border border-gray-100 dark:border-white/5 space-y-8",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center mb-8",children:[e.jsx("input",{type:"file",ref:y,onChange:N,className:"hidden",accept:"image/*"}),e.jsxs("div",{className:"relative group cursor-pointer",onClick:w,children:[e.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-4 border-gray-100 dark:border-white/10 shadow-lg",children:r.photoUrl?e.jsx("img",{src:r.photoUrl,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gray-200 dark:bg-[#222] flex items-center justify-center text-4xl font-bold text-gray-400",children:r.name.charAt(0)})}),e.jsx("div",{className:"absolute inset-0 bg-black/40 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(z,{className:"w-8 h-8 text-white"})})]}),e.jsx("p",{className:"mt-4 text-sm text-gray-500 hover:text-[#FD295E] cursor-pointer",onClick:w,children:"Clique para alterar a foto"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white border-b border-gray-100 dark:border-white/10 pb-2",children:"Informações Pessoais"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nome Completo"}),e.jsxs("div",{className:"relative",children:[e.jsx(R,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",name:"name",value:r.name,onChange:m,className:"w-full pl-10 p-3 bg-gray-50 dark:bg-[#1a1a1a] border border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#FD295E] outline-none transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Cargo / Função"}),e.jsxs("div",{className:"relative",children:[e.jsx(_,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",name:"role",value:r.role,onChange:m,className:"w-full pl-10 p-3 bg-gray-50 dark:bg-[#1a1a1a] border border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#FD295E] outline-none transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Biografia"}),e.jsx("textarea",{name:"bio",rows:"4",value:r.bio,onChange:m,className:"w-full p-3 bg-gray-50 dark:bg-[#1a1a1a] border border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#FD295E] outline-none transition-all resize-none"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white border-b border-gray-100 dark:border-white/10 pb-2",children:"Segurança e Acesso"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(D,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"email",name:"email",value:(a==null?void 0:a.email)||r.email,readOnly:!0,disabled:!0,className:"w-full pl-10 p-3 bg-gray-100 dark:bg-[#222] border border-gray-200 dark:border-white/5 rounded-xl text-gray-500 dark:text-gray-400 cursor-not-allowed opacity-75 outline-none transition-all"}),e.jsxs("span",{className:"absolute right-3 top-3.5 text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(b,{className:"w-3 h-3"})," Sistema"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",name:"password",placeholder:"Deixe em branco para manter a atual",value:r.password,onChange:m,className:"w-full pl-10 p-3 bg-gray-50 dark:bg-[#1a1a1a] border border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#FD295E] outline-none transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Confirmar Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(b,{className:"absolute left-3 top-3.5 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"password",name:"confirmPassword",placeholder:"Confirme a nova senha",value:r.confirmPassword,onChange:m,className:"w-full pl-10 p-3 bg-gray-50 dark:bg-[#1a1a1a] border border-gray-200 dark:border-white/10 rounded-xl text-gray-900 dark:text-white focus:ring-2 focus:ring-[#FD295E] outline-none transition-all"})]})]})]})]}),e.jsx("div",{className:"pt-6 border-t border-gray-100 dark:border-white/10 flex justify-end",children:e.jsxs("button",{type:"submit",className:"px-8 py-3 bg-[#FD295E] hover:bg-[#e11d48] text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),"Salvar Alterações"]})})]})]})}export{H as UserProfile};
